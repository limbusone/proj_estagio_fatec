<% content_for(:custom_javascript_includes) do %>
<%= javascript_include_tag "tces/scriptaux" %>
<% end %>
<% content_for(:custom_css_includes) do %>
<%= stylesheet_link_tag "tces/cascade", :media => "all" %>
<% end %>
<% if @detalhe_termo.errors.any? %>
  <div class="alert alert-error">
    <strong><%= pluralize(@detalhe_termo.errors.count, "Erro") %>:</strong>
    <ul>
    <% @detalhe_termo.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>
<%
  d = Hash.new
  d['segunda'], d['terca'], d['quarta'], d['quinta'], d['sexta'], d['sabado'], d['domingo'] = [], [], [], 
  [], [], [], []
  d['hr_almoco'] = nil  
  if ar = !@ar_horas_dias.empty?
    d['hr_almoco'] = @ar_horas_dias.first
    for i in 1...@ar_horas_dias.length do
      case @ar_horas_dias[i].dia_semana
      when 0 #segunda
        d['segunda']  << @ar_horas_dias[i]
      when 1 #terca
        d['terca']    << @ar_horas_dias[i]
      when 2 #quarta
        d['quarta']   << @ar_horas_dias[i]
      when 3 #quinta
        d['quinta']   << @ar_horas_dias[i]
      when 4 #sexta
        d['sexta']    << @ar_horas_dias[i]
      when 5 #sabado
        d['sabado']   << @ar_horas_dias[i]
      else #domingo
        d['domingo']  << @ar_horas_dias[i]
      end
    end 
  end
%>
<h1>Novo Termo de Compromisso de Estágio</h1>
<div>
  <h5>1 - Dados Gerais</h5><h2>2 - Horário de trabalho</h2><h5>3 - Atividades</h5>
</div>
<br />
<%= form_tag({:controller => "tces", :action => "createHorasDias"}, :method => "post", :class => "form-inline") do%>
  <!--<input type="button" value="&nbsp;&nbsp;+&nbsp;&nbsp;" id="addCampos" /> -->
  <input type="hidden" value="<%= @detalhe_termo_id %>" name="hidId" />
  <!--
  <input type="radio" name="opcao_horario" value="0" checked="true"/> manhã e tarde <br />
  <input type="radio" name="opcao_horario" value="1" /> manhã e noite <br /><br />
  -->
  <h3>Horário de almoço</h3><br />
  <div class="fields well">
    <%= label_tag "horario_almoco_inicio", "Inicio:" %>
    <%= select_time (ar) ? d['hr_almoco'].inicio : Time.now, options = { :prefix => "horario_almoco_inicio" }, 
    html_options = { :class => "selecting2", :tipo => "inicio" } %>
    <%= label_tag "horario_almoco_final", "Final:" %>
    <%= select_time (ar) ? d['hr_almoco'].final : Time.now, options = { :prefix => "horario_almoco_final" }, 
    html_options = { :class => "selecting2", :tipo => "final" }  %>
  </div>
  <br />
  <h3>Horários</h3><br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Segunda-feira
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['segunda'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['segunda'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['segunda'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['segunda'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />    
    <div class="f">
      <%= label_tag "dias_semana[segunda][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['segunda'].empty?) ? d['segunda'].first.inicio : Time.now, options = { :prefix => "dias_semana[segunda][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[segunda][final][]", "Final:" %>
      <%= select_time (ar && !d['segunda'].empty?) ? d['segunda'].first.final : Time.now, options = { :prefix => "dias_semana[segunda][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" }  %>
    </div>
    <div class="newFields">
      <% if d['segunda'].length > 1%>
        <% for i in 1...d['segunda'].length do %>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[segunda][inicio][]", "Inicio:" %>
            <%= select_time d['segunda'][i].inicio, options = { :prefix => "dias_semana[segunda][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[segunda][final][]", "Final:" %>
            <%= select_time d['segunda'][i].final, options = { :prefix => "dias_semana[segunda][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" }  %>
          </div>
        <% end %>
      <% end %>        
    </div>
  </div>
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Terça-feira
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['terca'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['terca'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['terca'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['terca'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
    	<a class="btn cmdAddFields" href="javascript:void;">
    	  <i class="icon-plus"></i>
    	</a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>    	
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
  	</div>
  	<br /><br />
    <div class="f">    
      <%= label_tag "dias_semana[terca][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['terca'].empty?) ? d['terca'].first.inicio : Time.now, options = { :prefix => "dias_semana[terca][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[terca][final][]", "Final:" %>
      <%= select_time (ar && !d['terca'].empty?) ? d['terca'].first.final : Time.now, options = { :prefix => "dias_semana[terca][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['terca'].length > 1%>
        <% for i in 1...d['terca'].length do %>
          <div class="f">          
            <br />
            <%= label_tag "dias_semana[terca][inicio][]", "Inicio:" %>
            <%= select_time d['terca'][i].inicio, options = { :prefix => "dias_semana[terca][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[terca][final][]", "Final:" %>
            <%= select_time d['terca'][i].final, options = { :prefix => "dias_semana[terca][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" }  %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>  
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Quarta-feira
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['quarta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['quarta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['quarta'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['quarta'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />

    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <div class="f">
      <%= label_tag "dias_semana[quarta][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['quarta'].empty?) ? d['quarta'].first.inicio : Time.now, options = { :prefix => "dias_semana[quarta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[quarta][final][]", "Final:" %>
      <%= select_time (ar && !d['quarta'].empty?) ? d['quarta'].first.final : Time.now, options = { :prefix => "dias_semana[quarta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['quarta'].length > 1%>
        <% for i in 1...d['quarta'].length do %>
          <div class="f">        
            <br />
            <%= label_tag "dias_semana[quarta][inicio][]", "Inicio:" %>
            <%= select_time d['quarta'][i].inicio, options = { :prefix => "dias_semana[quarta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[quarta][final][]", "Final:" %>
            <%= select_time d['quarta'][i].final, options = { :prefix => "dias_semana[quarta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>
        <% end %>
      <% end %>      
    </div>
  </div>
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Quinta-feira
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['quinta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['quinta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['quinta'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['quinta'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <div class="f">
      <%= label_tag "dias_semana[quinta][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['quinta'].empty?) ? d['quinta'].first.inicio : Time.now, options = { :prefix => "dias_semana[quinta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[quinta][final][]", "Final:" %>
      <%= select_time (ar && !d['quinta'].empty?) ? d['quinta'].first.final : Time.now, options = { :prefix => "dias_semana[quinta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['quinta'].length > 1%>
        <% for i in 1...d['quinta'].length do %>
          <div class="f">        
            <br />
            <%= label_tag "dias_semana[quinta][inicio][]", "Inicio:" %>
            <%= select_time d['quinta'][i].inicio, options = { :prefix => "dias_semana[quinta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[quinta][final][]", "Final:" %>
            <%= select_time d['quinta'][i].final, options = { :prefix => "dias_semana[quinta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>
        <% end %>
      <% end %>      
    </div>
  </div>
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Sexta-feira
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['sexta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['sexta'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['sexta'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['sexta'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <div class="f">
      <%= label_tag "dias_semana[sexta][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['sexta'].empty?) ? d['sexta'].first.inicio : Time.now, options = { :prefix => "dias_semana[sexta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[sexta][final][]", "Final:" %>
      <%= select_time (ar && !d['sexta'].empty?) ? d['sexta'].first.final : Time.now, options = { :prefix => "dias_semana[sexta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['sexta'].length > 1%>
        <% for i in 1...d['sexta'].length do %>
          <div class="f">        
            <br />
            <%= label_tag "dias_semana[sexta][inicio][]", "Inicio:" %>
            <%= select_time d['sexta'][i].inicio, options = { :prefix => "dias_semana[sexta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[sexta][final][]", "Final:" %>
            <%= select_time d['sexta'][i].final, options = { :prefix => "dias_semana[sexta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>          
        <% end %>
      <% end %>      
    </div>
  </div>
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Sábado
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['sabado'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['sabado'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['sabado'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['sabado'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <div class="f">
      <%= label_tag "dias_semana[sabado][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['sabado'].empty?) ? d['sabado'].first.inicio : Time.now, options = { :prefix => "dias_semana[sabado][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[sabado][final][]", "Final:" %>
      <%= select_time (ar && !d['sabado'].empty?) ? d['sabado'].first.final : Time.now, options = { :prefix => "dias_semana[sabado][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['sabado'].length > 1%>
        <% for i in 1...d['sabado'].length do %>
          <div class="f">          
            <br />
            <%= label_tag "dias_semana[sabado][inicio][]", "Inicio:" %>
            <%= select_time d['sabado'][i].inicio, options = { :prefix => "dias_semana[sabado][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[sabado][final][]", "Final:" %>
            <%= select_time d['sabado'][i].final, options = { :prefix => "dias_semana[sabado][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>                    
        <% end %>

      <% end %>      
    </div>
  </div>
  <br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Domingo
    <i class="<%= (!ar) ? "icon-chevron-up" : (!d['domingo'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>" 
      classorigem="<%= (!ar) ? "icon-chevron-up" : (!d['domingo'].empty?) ? "icon-chevron-up" : "icon-chevron-down" %>"></i>
  </a><br /><br />
  <div class="fields well" <%= (!ar) ? "style='display : block'" : (!d['domingo'].empty?) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (!ar) ?  1 : (!d['domingo'].empty?) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />    
    <div class="f">    
      <%= label_tag "dias_semana[domingo][inicio][]", "Inicio:" %>
      <%= select_time (ar && !d['domingo'].empty?) ? d['domingo'].first.inicio : Time.now, options = { :prefix => "dias_semana[domingo][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[domingo][final][]", "Final:" %>
      <%= select_time (ar && !d['domingo'].empty?) ? d['domingo'].first.final : Time.now, options = { :prefix => "dias_semana[domingo][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if d['domingo'].length > 1%>
        <% for i in 1...d['domingo'].length do %>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[domingo][inicio][]", "Inicio:" %>
            <%= select_time d['domingo'][i].inicio, options = { :prefix => "dias_semana[domingo][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[domingo][final][]", "Final:" %>
            <%= select_time d['domingo'][i].final, options = { :prefix => "dias_semana[domingo][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>          
        <% end %>
      <% end %>      
    </div>
  </div>
  <br />
  <div class="fields">
    <div class="control-group">
      <%= label_tag "carga_horaria", "Carga horária:" %>
      <div class="controls">
        <%= text_field_tag "carga_horaria", (ar) ? @detalhe_termo.carga_horaria_semanal : "0", :class => "uneditable-input", :readonly => "readonly" %>
        <a class="btn btn-small cmdCalcularCargaHoraria">
          <i class="icon-check"></i>
          Calcular
        </a>    
      </div>
    </div>
  </div>
  <input type="hidden" name="hidConclusao" id="hidConclusao" value="0" />
  <div class="form-actions">
    <button type="submit" class="btn cmdConclusao" name="commit">
      <i class="icon-ok"></i>
      Concluir
    </button>      
    <% 
      #f.submit "Próximo", :class => "btn btn-primary"
      if (va = @detalhe_termo.lista_atividades.empty?) 
    %>
      <button type="submit" class="btn btn-primary" name="commit">
        <i class="icon-share-alt"></i>
        Próximo
      </button>
    <% end %>
  </div>
<% end %>
