<% content_for(:custom_javascript_includes) do %>
<%= javascript_include_tag "tces/scriptaux" %>
<% end %>
<% content_for(:custom_css_includes) do %>
<%= stylesheet_link_tag "tces/cascade", :media => "all" %>
<% end %>
<% if @detalhe_termo.errors.any? %>
  <div class="alert alert-error">
    <strong><%= pluralize(@detalhe_termo.errors.count, "Erro") %>:</strong>

    <ul>
    <% @detalhe_termo.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>
<h1>Editando Termo de Compromisso de Estágio</h1>
<br />
<div>
  <h2>Horário de trabalho</h2>
</div>
<br />
<%= form_tag({:controller => "tces", :action => "updateHorasDias"}, :method => "post", :class => "form-inline") do%>
  <!--<input type="button" value="&nbsp;&nbsp;+&nbsp;&nbsp;" id="addCampos" /> -->
  <input type="hidden" value="<%= @detalhe_termo_id %>" name="hidId" />
  <!--
  <input type="radio" name="opcao_horario" value="0" checked="true"/> manhã e tarde <br />
  <input type="radio" name="opcao_horario" value="1" /> manhã e noite <br /><br />
  -->
  <h3>Horário de almoço</h3><br />
  <div class="fields well">
    <% al = @detalhe_termo.hora_dias.where("tipo = ?", false).first %>
    
    <%= label_tag "horario_almoco_inicio", "Inicio:" %>
    <%= select_time Time.new(DateTime.now.year, DateTime.now.month, DateTime.now.day, al.inicio.hour, al.inicio.min), 
    options = { :prefix => "horario_almoco_inicio" }, 
    html_options = { :class => "selecting2", :tipo => "inicio" } %>
    <%= label_tag "horario_almoco_final", "Final:" %>
    <%= select_time Time.new(DateTime.now.year, DateTime.now.month, DateTime.now.day, al.final.hour, al.final.min), options = { :prefix => "horario_almoco_final" }, 
    html_options = { :class => "selecting2", :tipo => "final" }  %>
  </div>
  <br />
  <% 
    se  = @detalhe_termo.hora_dias.where("dia_semana = ?", 0).first
  %>  
  <h3>Horários</h3><br />
  <a class="toggling btn btn-large" href="javascript:void;">
    Segunda-feira
    <i class="<%= (se) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (se) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (se) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (se) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">
      <%= label_tag "dias_semana[segunda][inicio][]", "Inicio:" %>
      <%= select_time (se) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, se.inicio.hour, se.inicio.min) : Time.now, options = { :prefix => "dias_semana[segunda][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[segunda][final][]", "Final:" %>
      <%= select_time (se) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, se.final.hour, se.final.min) : Time.now, options = { :prefix => "dias_semana[segunda][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" }  %>
    </div>
    <div class="newFields"></div>
  </div>
  <br />
  <% 
    t = @detalhe_termo.hora_dias.where("dia_semana = ?", 1)
    te = t.exists?
  %>  
  <a class="toggling btn btn-large" href="javascript:void;">
    Terça-feira
    <i class="<%= (te) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (te) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (te) ? "style='display : block'" : "style='display : none'"%>>
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <input type="hidden" value="<%= (te) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">    
      <%= label_tag "dias_semana[terca][inicio][]", "Inicio:" %>
      <%= select_time (te) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, t.first.inicio.hour, t.first.inicio.min) : Time.now, options = { :prefix => "dias_semana[terca][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[terca][final][]", "Final:" %>
      <%= select_time (te) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, t.first.final.hour, t.first.final.min) : Time.now, options = { :prefix => "dias_semana[terca][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if (t.length > 1)%>
        <% for i in 1...t.length do%>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[terca][inicio][]", "Inicio:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, t[i].inicio.hour, t[i].inicio.min), options = { :prefix => "dias_semana[terca][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[terca][final][]", "Final:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, t[i].final.hour, t[i].final.min), options = { :prefix => "dias_semana[terca][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>  
  <br />
  <% 
    qa = @detalhe_termo.hora_dias.where("dia_semana = ?", 2)
    qae = qa.exists?
  %>  
  <a class="toggling btn btn-large" href="javascript:void;">
    Quarta-feira
    <i class="<%= (qae) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (qae) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (qae) ? "style='display : block'" : "style='display : none'"%>>
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <input type="hidden" value="<%= (qae) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">
      <%= label_tag "dias_semana[quarta][inicio][]", "Inicio:" %>
      <%= select_time (qae) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, qa.first.inicio.hour, qa.first.inicio.min) : Time.now, options = { :prefix => "dias_semana[quarta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[quarta][final][]", "Final:" %>
      <%= select_time (qae) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, qa.first.final.hour, qa.first.final.min) : Time.now, options = { :prefix => "dias_semana[quarta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if (qa.length > 1)%>
        <% for i in 1...qa.length do%>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[quarta][inicio][]", "Inicio:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, qa[i].inicio.hour, qa[i].inicio.min), options = { :prefix => "dias_semana[quarta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[quarta][final][]", "Final:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, qa[i].final.hour, qa[i].final.min), options = { :prefix => "dias_semana[quarta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>            
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
  <br />
  <% 
    qi = @detalhe_termo.hora_dias.where("dia_semana = ?", 3)
    qie = qi.exists?
  %>
  <a class="toggling btn btn-large" href="javascript:void;">
    Quinta-feira
    <i class="<%= (qie) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (qie) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (qie) ? "style='display : block'" : "style='display : none'"%>>
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <input type="hidden" value="<%= (qie) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">
      <%= label_tag "dias_semana[quinta][inicio][]", "Inicio:" %>
      <%= select_time (qie) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, qi.first.inicio.hour, qi.first.inicio.min) : Time.now, options = { :prefix => "dias_semana[quinta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[quinta][final][]", "Final:" %>
      <%= select_time (qie) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, qi.first.final.hour, qi.first.final.min) : Time.now, options = { :prefix => "dias_semana[quinta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if (qi.length > 1)%>
        <% for i in 1...qi.length do%>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[quinta][inicio][]", "Inicio:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, qi[i].inicio.hour, qi[i].inicio.min), options = { :prefix => "dias_semana[quinta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[quinta][final][]", "Final:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, qi[i].final.hour, qi[i].final.min), options = { :prefix => "dias_semana[quinta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>            
          </div>
        <% end %>
      <% end %>      
    </div>
  </div>
  <br />
  <% 
    sx = @detalhe_termo.hora_dias.where("dia_semana = ?", 4)
    sxe = sx.exists?
  %>  
  <a class="toggling btn btn-large" href="javascript:void;">
    Sexta-feira
    <i class="<%= (sxe) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (sxe) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (sxe) ? "style='display : block'" : "style='display : none'"%>>
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <input type="hidden" value="<%= (sxe) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">
      <%= label_tag "dias_semana[sexta][inicio][]", "Inicio:" %>
      <%= select_time (sxe) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, sx.first.inicio.hour, sx.first.inicio.min) : Time.now, options = { :prefix => "dias_semana[sexta][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[sexta][final][]", "Final:" %>
      <%= select_time (sxe) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, sx.first.final.hour, sx.first.final.min) : Time.now, options = { :prefix => "dias_semana[sexta][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if (sx.length > 1)%>
        <% for i in 1...sx.length do%>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[sexta][inicio][]", "Inicio:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, sx[i].inicio.hour, sx[i].inicio.min), options = { :prefix => "dias_semana[sexta][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[sexta][final][]", "Final:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, sx[i].final.hour, sx[i].final.min), options = { :prefix => "dias_semana[sexta][final][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
  <br />
  <% 
    sb = @detalhe_termo.hora_dias.where("dia_semana = ?", 5)
    sbe = sb.exists?
  %>  
  <a class="toggling btn btn-large" href="javascript:void;">
    Sábado
    <i class="<%= (sbe) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (sbe) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (sbe) ? "style='display : block'" : "style='display : none'"%>>
    <div class="btn-group">
      <a class="btn cmdAddFields" href="javascript:void;">
        <i class="icon-plus"></i>
      </a>
      <a class="btn cmdRemoveField" href="javascript:void;">
        <i class="icon-minus"></i>
      </a>      
      <a class="btn cmdRemoveNovosFields" href="javascript:void;">
        <i class="icon-remove"></i>
      </a>
    </div>
    <br /><br />
    <input type="hidden" value="<%= (sbe) ? 1 : 0%>" name="campos_dia_semana[]" />    
    <div class="f">
      <%= label_tag "dias_semana[sabado][inicio][]", "Inicio:" %>
      <%= select_time (sbe) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, sb.first.inicio.hour, sb.first.inicio.min) : Time.now, options = { :prefix => "dias_semana[sabado][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[sabado][final][]", "Final:" %>
      <%= select_time (sbe) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, sb.first.final.hour, sb.first.final.min) : Time.now, options = { :prefix => "dias_semana[sabado][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
    <div class="newFields">
      <% if (sb.length > 1)%>
        <% for i in 1...sb.length do%>
          <div class="f">
            <br />
            <%= label_tag "dias_semana[sabado][inicio][]", "Inicio:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, s[i].inicio.hour, s[i].inicio.min), options = { :prefix => "dias_semana[sabado][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "inicio" } %>
            <%= label_tag "dias_semana[sabado][final][]", "Final:" %>
            <%= select_time Time.new(DateTime.now.year, 
            DateTime.now.month, DateTime.now.day, s[i].final.hour, s[i].final.min), options = { :prefix => "dias_semana[sabado][inicio][]" }, 
            html_options = { :class => "selecting2", :tipo => "final" } %>
          </div>          
        <% end %>
      <% end %>
    </div>
  </div>
  <br />
  <% 
    dom = @detalhe_termo.hora_dias.where("dia_semana = ?", 6).first
  %>  
  <a class="toggling btn btn-large" href="javascript:void;">
    Domingo
    <i class="<%= (dom) ? "icon-chevron-up" : "icon-chevron-down"%>" 
      classorigem="<%= (dom) ? "icon-chevron-up" : "icon-chevron-down"%>"></i>
  </a><br /><br />
  <div class="fields well" <%= (dom) ? "style='display : block'" : "style='display : none'"%>>
    <input type="hidden" value="<%= (dom) ? 1 : 0%>" name="campos_dia_semana[]" />
    <div class="f">    
      <%= label_tag "dias_semana[domingo][inicio][]", "Inicio:" %>
      <%= select_time (dom) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, dom.inicio.hour, dom.inicio.min) : Time.now, 
      options = { :prefix => "dias_semana[domingo][inicio][]" }, 
      html_options = { :class => "selecting2", :tipo => "inicio" } %>
      <%= label_tag "dias_semana[domingo][final][]", "Final:" %>
      <%= select_time (dom) ? Time.new(DateTime.now.year, 
      DateTime.now.month, DateTime.now.day, dom.final.hour, dom.final.min) : Time.now, 
      options = { :prefix => "dias_semana[domingo][final][]" }, 
      html_options = { :class => "selecting2", :tipo => "final" } %>
    </div>
  </div>
  <br />
  <div class="fields">
    <div class="control-group">
      <%= label_tag "carga_horaria", "Carga horária:" %>
      <div class="controls">
        <%= text_field_tag "carga_horaria", @detalhe_termo.carga_horaria_semanal, 
        :class => "uneditable-input", :readonly => "readonly" %>
        <a class="btn btn-small cmdCalcularCargaHoraria">
          <i class="icon-check"></i>
          Calcular
        </a>    
      </div>
    </div>
  </div>
  <input type="hidden" name="hidConclusao" id="hidConclusao" value="0" />
  <div class="form-actions">
    <button type="submit" class="btn cmdConclusao btn-primary" name="commit">
      <i class="icon-ok"></i>
      Enviar
    </button>      
  </div>
<% end %>
